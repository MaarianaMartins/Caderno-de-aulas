{
  "hash": "5391a88a715c6e5bdcf1ddf7dbbdaeeb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 8- transformações, ANOVA e teste de média\"\nformat: html\neditor_options: \n  chunk_output_type: console\n---\n\n\n# ANOVA com blocos casualizados\n\n## Importa dados\n\nPara cada variável-resposta será feito um ANOVA. Modificar o ANOVA para considerar o bloco como efeito fixo Temos que modificar o número do tratamento e os números do bloco como fatores.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#theme_set(theme_bw())\nlibrary(tidyverse)\nlibrary(gsheet)\n\nsoja <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=866852711\")\n\nsoja <- soja |> \n  mutate(TRAT = as.factor(TRAT),\n         BLOCO = as.factor(BLOCO))\n```\n:::\n\n\n##Visualizar Gráfico 1 para a variavel DFC Gráfico 2 para a variavel FER Grafico 3 para a variavel PROD\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndfc <- soja |> \n  ggplot(aes(TRAT, DFC))+\n  geom_jitter(width = 0.05, color = \"gray70\")+\n  stat_summary(fun.data = \"mean_cl_boot\", color = \"black\") #A bola preta representa a média e a linha o intervalo de confiança\ndfc\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nfer <- soja |> \n  ggplot(aes(TRAT, FER))+\n  geom_jitter(width = 0.1)\nfer\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nprod <- soja |> \n  ggplot(aes(TRAT, PROD))+\n  geom_jitter(width = 0.1)\nprod\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\nlibrary(patchwork)\ndfc / fer / prod\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n:::\n\n\n## ANOVA DFC\n\nPvalor indicando com \\*\\*\\* e o valor super baixo, indiccando que o efeito do tratamento é extremamente significativo. Para blocos, não foi significativo. Pode seguir as análises por que pelo menos uma das médias difere uma da outra, agora temos que saber se podemos confiar na anova e testar as suas premissas de normalidade e homosdasticidade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_dfc <- lm(DFC ~ TRAT+BLOCO,  #Bloco entra como efeito fixo ao colocar o \"+\"\n              data = soja)\nanova(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: DFC\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 149.299 21.3284 51.5490 8.218e-12 ***\nBLOCO      3   0.461  0.1537  0.3716    0.7743    \nResiduals 21   8.689  0.4138                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n#Grau de liberdade = n-1\n#F é a divisão entre os Mean Square\n# Trat é extremamente significativo\n\nlibrary(performance)\ncheck_heteroscedasticity(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.532).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.978).\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(emmeans)\nmedias_dfc <- emmeans(aov_dfc, ~ TRAT)\nmedias_dfc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean    SE df lower.CL upper.CL\n 1     10.88 0.322 21    10.21    11.54\n 2      6.42 0.322 21     5.76     7.09\n 3      6.05 0.322 21     5.38     6.72\n 4      4.75 0.322 21     4.08     5.42\n 5      4.20 0.322 21     3.53     4.87\n 6      4.00 0.322 21     3.33     4.67\n 7      4.08 0.322 21     3.41     4.74\n 8      4.58 0.322 21     3.91     5.24\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(medias_dfc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7       8\n1 [10.87]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001\n2   4.450 [ 6.42]  0.9896  0.0249  0.0017  0.0006  0.0009  0.0107\n3   4.825   0.375 [ 6.05]  0.1329  0.0107  0.0040  0.0058  0.0628\n4   6.125   1.675   1.300 [ 4.75]  0.9202  0.7173  0.8072  0.9999\n5   6.675   2.225   1.850   0.550 [ 4.20]  0.9998  1.0000  0.9896\n6   6.875   2.425   2.050   0.750   0.200 [ 4.00]  1.0000  0.9020\n7   6.800   2.350   1.975   0.675   0.125  -0.075 [ 4.07]  0.9499\n8   6.300   1.850   1.475   0.175  -0.375  -0.575  -0.500 [ 4.57]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(multcomp)\nlibrary(multcompView)\ncld(medias_dfc, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean    SE df lower.CL upper.CL .group\n 6      4.00 0.322 21     3.33     4.67  a    \n 7      4.08 0.322 21     3.41     4.74  a    \n 5      4.20 0.322 21     3.53     4.87  a    \n 8      4.58 0.322 21     3.91     5.24  ab   \n 4      4.75 0.322 21     4.08     5.42  ab   \n 3      6.05 0.322 21     5.38     6.72   bc  \n 2      6.42 0.322 21     5.76     7.09    c  \n 1     10.88 0.322 21    10.21    11.54     d \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n#Eficácia no controle (%) = (1- (emmean do tratamento/emmean da testemunha))*100\n```\n:::\n\n\n## ANOVA FER\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_fer <- lm(FER ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: FER\n          Df Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 978.87 139.838 55.1717 4.218e-12 ***\nBLOCO      3   3.84   1.279  0.5045    0.6834    \nResiduals 21  53.23   2.535                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(performance)\ncheck_heteroscedasticity(aov_fer) #Variância não é homogênea\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p < .001).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer) #Não há normalidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Non-normality of residuals detected (p = 0.008).\n```\n\n\n:::\n\n```{.r .cell-code}\n#Transformação dos dados\nsoja <- soja |> \n  mutate(FER2 = log(FER))\n\naov_fer2 <- lm(FER2 ~ TRAT+BLOCO,\n               data = soja)\nanova(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: FER2\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \nTRAT       7 11.5210 1.64585 42.9665 4.838e-11 ***\nBLOCO      3  0.2064 0.06880  1.7961    0.1788    \nResiduals 21  0.8044 0.03831                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.255).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer2) #Ainda não é homogêneo, mas iremos considerar como homogêneo\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nWarning: Heteroscedasticity (non-constant error variance) detected (p = 0.035).\n```\n\n\n:::\n\n```{.r .cell-code}\nmedias_fer <- emmeans(aov_fer2, ~ TRAT)\nmedias_fer\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL\n 1      3.00 0.0979 21    2.793     3.20\n 2      1.74 0.0979 21    1.533     1.94\n 3      1.34 0.0979 21    1.133     1.54\n 4      1.12 0.0979 21    0.921     1.33\n 5      1.18 0.0979 21    0.972     1.38\n 6      1.09 0.0979 21    0.888     1.30\n 7      1.21 0.0979 21    1.011     1.42\n 8      1.25 0.0979 21    1.044     1.45\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(medias_fer)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7      8\n1  [3.00]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001 <.0001\n2  1.2600  [1.74]  0.1252  0.0048  0.0110  0.0028  0.0204 0.0343\n3  1.6600  0.4000  [1.34]  0.7832  0.9335  0.6440  0.9843 0.9976\n4  1.8718  0.6118  0.2118  [1.12]  0.9999  1.0000  0.9976 0.9842\n5  1.8211  0.5611  0.1611 -0.0507  [1.18]  0.9984  1.0000 0.9994\n6  1.9052  0.6452  0.2452  0.0334  0.0841  [1.09]  0.9842 0.9431\n7  1.7825  0.5225  0.1226 -0.0893 -0.0385 -0.1227  [1.21] 1.0000\n8  1.7491  0.4891  0.0892 -0.1227 -0.0719 -0.1560 -0.0334 [1.25]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_fer, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL .group\n 6      1.09 0.0979 21    0.888     1.30  a    \n 4      1.12 0.0979 21    0.921     1.33  a    \n 5      1.18 0.0979 21    0.972     1.38  a    \n 7      1.21 0.0979 21    1.011     1.42  a    \n 8      1.25 0.0979 21    1.044     1.45  a    \n 3      1.34 0.0979 21    1.133     1.54  ab   \n 2      1.74 0.0979 21    1.533     1.94   b   \n 1      3.00 0.0979 21    2.793     3.20    c  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\n#Tentando arrumar a normalidade por Lambda\nb <- boxcox(lm(soja$FER ~ 1))\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nlambda <- b$x[which.max(b$y)]\nlambda\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] -1.555556\n```\n\n\n:::\n\n```{.r .cell-code}\nsoja$FER3 <- (soja$FER ^ lambda - 1)/ lambda\naov_fer3 <- lm(FER3 ~ TRAT+BLOCO,\n              data = soja)\ncheck_normality(aov_fer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.787).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_fer3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.872).\n```\n\n\n:::\n\n```{.r .cell-code}\nmedias_fer2 <- emmeans(aov_fer2, ~ TRAT)\nmedias_fer2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL\n 1      3.00 0.0979 21    2.793     3.20\n 2      1.74 0.0979 21    1.533     1.94\n 3      1.34 0.0979 21    1.133     1.54\n 4      1.12 0.0979 21    0.921     1.33\n 5      1.18 0.0979 21    0.972     1.38\n 6      1.09 0.0979 21    0.888     1.30\n 7      1.21 0.0979 21    1.011     1.42\n 8      1.25 0.0979 21    1.044     1.45\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(medias_fer2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7      8\n1  [3.00]  <.0001  <.0001  <.0001  <.0001  <.0001  <.0001 <.0001\n2  1.2600  [1.74]  0.1252  0.0048  0.0110  0.0028  0.0204 0.0343\n3  1.6600  0.4000  [1.34]  0.7832  0.9335  0.6440  0.9843 0.9976\n4  1.8718  0.6118  0.2118  [1.12]  0.9999  1.0000  0.9976 0.9842\n5  1.8211  0.5611  0.1611 -0.0507  [1.18]  0.9984  1.0000 0.9994\n6  1.9052  0.6452  0.2452  0.0334  0.0841  [1.09]  0.9842 0.9431\n7  1.7825  0.5225  0.1226 -0.0893 -0.0385 -0.1227  [1.21] 1.0000\n8  1.7491  0.4891  0.0892 -0.1227 -0.0719 -0.1560 -0.0334 [1.25]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_fer2, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean     SE df lower.CL upper.CL .group\n 6      1.09 0.0979 21    0.888     1.30  a    \n 4      1.12 0.0979 21    0.921     1.33  a    \n 5      1.18 0.0979 21    0.972     1.38  a    \n 7      1.21 0.0979 21    1.011     1.42  a    \n 8      1.25 0.0979 21    1.044     1.45  a    \n 3      1.34 0.0979 21    1.133     1.54  ab   \n 2      1.74 0.0979 21    1.533     1.94   b   \n 1      3.00 0.0979 21    2.793     3.20    c  \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\nCom os resultados do CLD pode-se fazer uma tabela com as médias e as letrinhas, também o intervalo de confiança e pode omitir o erro padrão... Ou então uma tabelta mais larga com as 3 variaveis, ou então usar um gráfico e colocar as letras nele. Nunca mostrar a tabela e o gráfico, ai é redundância. \\## ANOVA PROD\n\n\n::: {.cell}\n\n```{.r .cell-code}\naov_prod <- lm(PROD ~ TRAT+BLOCO,\n              data = soja)\nanova(aov_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: PROD\n          Df  Sum Sq Mean Sq F value  Pr(>F)  \nTRAT       7 2993906  427701  2.6367 0.04021 *\nBLOCO      3  105665   35222  0.2171 0.88340  \nResiduals 21 3406431  162211                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(aov_prod) #Variância é homogênea\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.215).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(aov_prod) #Há normalidade\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.542).\n```\n\n\n:::\n\n```{.r .cell-code}\nmedias_prod <- emmeans(aov_prod, ~ TRAT)\nmedias_prod\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL\n 1      4219 201 21     3800     4638\n 2      4935 201 21     4516     5354\n 3      5110 201 21     4691     5529\n 4      5140 201 21     4721     5559\n 5      5122 201 21     4703     5541\n 6      5256 201 21     4837     5675\n 7      5128 201 21     4709     5546\n 8      5078 201 21     4659     5497\n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \n```\n\n\n:::\n\n```{.r .cell-code}\npwpm(medias_prod)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        1       2       3       4       5       6       7      8\n1  [4219]  0.2430  0.0792  0.0640  0.0728  0.0272  0.0700 0.0985\n2  -715.8  [4935]  0.9983  0.9953  0.9974  0.9430  0.9968 0.9995\n3  -890.8  -175.0  [5110]  1.0000  1.0000  0.9994  1.0000 1.0000\n4  -921.0  -205.3   -30.3  [5140]  1.0000  0.9999  1.0000 1.0000\n5  -902.8  -187.0   -12.0    18.3  [5122]  0.9997  1.0000 1.0000\n6 -1037.0  -321.3  -146.3  -116.0  -134.3  [5256]  0.9998 0.9981\n7  -908.3  -192.5   -17.5    12.8    -5.5   128.8  [5127] 1.0000\n8  -859.0  -143.3    31.7    62.0    43.7   178.0    49.2 [5078]\n\nRow and column labels: TRAT\nUpper triangle: P values   adjust = \"tukey\"\nDiagonal: [Estimates] (emmean) \nLower triangle: Comparisons (estimate)   earlier vs. later\n```\n\n\n:::\n\n```{.r .cell-code}\ncld(medias_prod, Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n TRAT emmean  SE df lower.CL upper.CL .group\n 1      4219 201 21     3800     4638  a    \n 2      4935 201 21     4516     5354  ab   \n 8      5078 201 21     4659     5497  ab   \n 3      5110 201 21     4691     5529  ab   \n 5      5122 201 21     4703     5541  ab   \n 7      5128 201 21     4709     5546  ab   \n 4      5140 201 21     4721     5559  ab   \n 6      5256 201 21     4837     5675   b   \n\nResults are averaged over the levels of: BLOCO \nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 8 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n\n```{.r .cell-code}\nmedias_prod_grupo <- cld(medias_prod, Letters = letters)\n```\n:::\n\n\nOutra forma de visualizar os valores da produtividade\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_prod <- data.frame(medias_prod_grupo)\ndf_prod |> \n  ggplot(aes(TRAT, emmean))+\n  geom_point()+\n  ylim(3000,6500)+\n  geom_errorbar(aes(min = lower.CL,\n                    max = upper.CL),\n                width = 0.1)+\n  annotate(geom = \"text\", x = 1.1, y = 4200, label = \"A\")+\n  annotate(geom = \"text\", x = 2.1, y = 5000, label = \"AB\")\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nknitr::kable(df_prod |> dplyr::select(TRAT, emmean, .group))\n```\n\n::: {.cell-output-display}\n\n\n|   |TRAT |  emmean|.group |\n|:--|:----|-------:|:------|\n|1  |1    | 4219.25|a      |\n|2  |2    | 4935.00|ab     |\n|8  |8    | 5078.25|ab     |\n|3  |3    | 5110.00|ab     |\n|5  |5    | 5122.00|ab     |\n|7  |7    | 5127.50|ab     |\n|4  |4    | 5140.25|ab     |\n|6  |6    | 5256.25|b      |\n\n\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\nwrite_xlsx(df_prod, \"df.xlsx\")\n\n#Diferença de produtividade = emmean do tratamento - emmean da testemunha\n```\n:::\n\n\nSe quiser colocar as letrinhas, tem que usar o anotate e fazer a \"colocação\" manualmente. Os dados 1 e 6 não tem overleap do intervlao de confiança, já os que tem o overleap ex 1 e 5 estão no mesmo grupo e não diferem estatisticamente. É uma maneira visual de determinar a diferença e fazer o leitor entender.\n\n# Novos dados Curve\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntheme_set(theme_bw())\ncurve <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1bq2N19DcZdtax2fQW9OHSGMR0X2__Z9T/edit#gid=1807247585\")\ncurve = as.data.frame(curve)\n\n\ncurve |> \n  group_by(day) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity),\n            severity_sd = sd(severity)) |> \n  ggplot(aes(day, severity_mean, color = Irrigation))+\n  geom_point(width = 0.05)+\n  geom_line()\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\ncurve |> \n  group_by(day, Irrigation) |> \n  summarise(severity_mean = mean(severity)) |> \n  ggplot(aes(day, severity_mean))+\n  geom_point(width = 0.05)+\n  geom_line()+\n  facet_grid(~Irrigation)\n```\n\n::: {.cell-output-display}\n![](Aula8_quarto_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\n#Área abaixo da curva\nlibrary(epifitter)\naudpc <- curve |> \n  group_by(Irrigation, rep) |> \n  summarise(aacpd = AUDPC(day, severity))\n\n#ANOVA da área debaixo da curva\naov_audpc <- lm(aacpd ~ Irrigation + factor(rep),\n                data = audpc) \nanova(aov_audpc)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n            Df  Sum Sq  Mean Sq F value  Pr(>F)  \nIrrigation   1 0.23602 0.236017  10.605 0.08275 .\nfactor(rep)  2 0.61291 0.306454  13.771 0.06770 .\nResiduals    2 0.04451 0.022254                  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\naov_curve <- lm(severity ~ Irrigation*day + rep,\n         data = curve)\nanova(aov_curve)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: severity\n               Df  Sum Sq Mean Sq   F value Pr(>F)    \nIrrigation      1 0.00067 0.00067    0.5419 0.4648    \nday             1 1.33121 1.33121 1082.0680 <2e-16 ***\nrep             1 0.00009 0.00009    0.0732 0.7878    \nIrrigation:day  1 0.00070 0.00070    0.5716 0.4528    \nResiduals      55 0.06766 0.00123                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(agricolae)\ncv.model(aov_audpc) #coeficiente de variação, que é o desvio padrão dividido por 100\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1.097572\n```\n\n\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}