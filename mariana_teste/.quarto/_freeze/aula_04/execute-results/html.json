{
  "hash": "b54b247a9e866adcc418023fab33e454",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Aula 4 - criação de dataframe e configuração dos dados\"\nformat: html\neditor: visual\nmessage: false\nwarning: false\n---\n\n\n## Conjunto de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncomp <- c(9, 125, 10, 8, 132, 11, 108, 95, 108, 104, 1372, 1591, 157, 142, 159, 1654, 18, 144, 1641, 16)\n```\n:::\n\n\n## Pacotes\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tibble)\nlibrary(data.table)\nlibrary(pak)\n```\n:::\n\n\nColando através do comando \"Data pasta\" (um data frame) um conjunto de dados de uma tabela.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndat <- data.frame(stringsAsFactors = FALSE,\n                      trat = c(\"Mg2\",\"Mg2\",\n                               \"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\"Mg2\",\n                               \"Mg2\",\"control\",\"control\",\"control\",\"control\",\n                               \"control\",\"control\",\"control\",\"control\",\n                               \"control\",\"control\"),\n                       rep = c(1L,2L,3L,4L,\n                               5L,6L,7L,8L,9L,10L,1L,2L,3L,4L,5L,6L,\n                               7L,8L,9L,10L),\n                      comp = c(9,125,10,8,\n                               132,11,108,95,108,104,1372,1591,157,142,\n                               159,1654,18,144,1641,16))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat2 <- tibble::tribble(\n         ~trat, ~rep, ~comp,\n         \"Mg2\",   1L,     9,\n         \"Mg2\",   2L,   125,\n         \"Mg2\",   3L,    10,\n         \"Mg2\",   4L,     8,\n         \"Mg2\",   5L,   132,\n         \"Mg2\",   6L,    11,\n         \"Mg2\",   7L,   108,\n         \"Mg2\",   8L,    95,\n         \"Mg2\",   9L,   108,\n         \"Mg2\",  10L,   104,\n     \"control\",   1L,  1372,\n     \"control\",   2L,  1591,\n     \"control\",   3L,   157,\n     \"control\",   4L,   142,\n     \"control\",   5L,   159,\n     \"control\",   6L,  1654,\n     \"control\",   7L,    18,\n     \"control\",   8L,   144,\n     \"control\",   9L,  1641,\n     \"control\",  10L,    16)\n```\n:::\n\n\n## Crianto tabelas a partir de dados\n\nImportando tabelas da internet usando a função \"addins\", \"paste as tribble\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nestados <- tibble::tribble(\n                          ~Cidade,               ~Região,  ~Habitantes,\n             \"Brasília / Capital\",    \"Distrito Federal\",  \"2.912.000\",\n                      \"São Paulo\",           \"São Paulo\", \"12.400.000\",\n                 \"Rio de Janeiro\",      \"Rio de Janeiro\",  \"6.748.000\",\n                      \"Fortaleza\",               \"Ceará\",  \"2.669.000\",\n                 \"Belo Horizonte\",        \"Minas Gerais\",  \"2.512.000\",\n                       \"Salvador\",               \"Bahia\",  \"2.418.000\",\n                         \"Manaus\",            \"Amazonas\",  \"2.220.000\",\n                       \"Curitiba\",              \"Paraná\",  \"1.964.000\",\n                         \"Recife\",          \"Pernambuco\",  \"1.653.000\",\n                        \"Goiânia\",               \"Goiás\",  \"1.536.000\",\n                          \"Belém\",                \"Pará\",  \"1.500.000\",\n                   \"Porto Alegre\",   \"Rio Grande do Sul\",  \"1.488.000\",\n                      \"Guarulhos\",           \"São Paulo\",  \"1.292.000\",\n                       \"Campinas\",           \"São Paulo\",  \"1.139.000\",\n                       \"São Luís\",            \"Maranhão\",  \"1.041.000\",\n                         \"Maceió\",             \"Alagoas\",  \"1.018.000\",\n                          \"Natal\", \"Rio Grande do Norte\",    \"884.000\",\n                   \"Campo Grande\",  \"Mato Grosso do Sul\",    \"884.000\",\n                       \"Teresina\",               \"Piauí\",    \"815.000\",\n                    \"João Pessoa\",             \"Paraíba\",    \"806.000\",\n                        \"Aracaju\",             \"Sergipe\",    \"571.000\",\n                    \"Porto Velho\",            \"Rondônia\",    \"483.000\",\n                  \"Florianópolis\",      \"Santa Catarina\",    \"482.000\",\n                         \"Macapá\",               \"Amapá\",    \"482.000\",\n                     \"Rio Branco\",                \"Acre\",    \"309.000\",\n                         \"Palmas\",           \"Tocantins\",    \"306.000\",\n                      \"Boa Vista\",             \"Roraima\",    \"278.000\",\n                         \"Cuiabá\",         \"Mato Grosso\",    \"221.000\",\n                        \"Vitória\",      \"Espírito Santo\",    \"212.000\")\n```\n:::\n\n\nDados dispostos em formato largo em 3 colunas diferentes. Para trabalharmos esses dados, é interessante que trabalhemos no formato longo, portanto, devemos adicionar todos em uma só coluna, transformando em data frame.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper <- \n  tribble(\n   ~t,  ~`1`,  ~`2`,  ~`3`,\n   0,  0.08, 0.001, 0.001,\n   7,  0.13,  0.01, 0.001,\n  14,  0.78,  0.09,  0.01,\n  21,  0.92,  0.25,  0.05,\n  28,  0.99,   0.8,  0.18,\n  35, 0.995,  0.98,  0.34,\n  42, 0.999,  0.99,  0.48,\n  49, 0.999, 0.999,  0.74) \n```\n:::\n\n\nPivot longer consegue transformar os dados do formato largo para o formato longo, para que possamos fazer um ggplot. Trabalhar com os dados em formato longo é muitas vezes preferível no R, especialmente ao utilizar os pacotes como `tidyverse`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper |> \n  pivot_longer(2:4,\n               names_to = \"Epidemic\",\n               values_to = \"inc\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 24 × 3\n       t Epidemic   inc\n   <dbl> <chr>    <dbl>\n 1     0 1        0.08 \n 2     0 2        0.001\n 3     0 3        0.001\n 4     7 1        0.13 \n 5     7 2        0.01 \n 6     7 3        0.001\n 7    14 1        0.78 \n 8    14 2        0.09 \n 9    14 3        0.01 \n10    21 1        0.92 \n# ℹ 14 more rows\n```\n\n\n:::\n:::\n\n\nCriação de gráficos de linhas com pontos. Gráficos de linhas com pontos são utilizados para visualizar dados ao longo do tempo ou outras variáveis contínuas. Eles combinam as características de gráficos de linhas e gráficos de dispersão, destacando tanto as tendências gerais quando os pontos de dados individuais.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npepper |> \n  pivot_longer(2:4, names_to = 'epidemic', \n               values_to = 'inc') |> \n  ggplot(aes(t, inc, color = epidemic)) +\n  geom_point() + \n  geom_line() + \n  annotate(geom = 'text',\n           x = 10,\n           y = 0.75,\n           label = '1') +\n  annotate(geom = 'text',\n         x = 25,\n         y = 0.75,\n         label = '2') +\n  annotate(geom = 'text',\n           x = 45,\n           y = 0.75,\n           label = '3')\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Aula 04 - Parte 02\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(janitor)\nlibrary(ggthemes)\nlibrary(gsheet)\n```\n:::\n\n\n### Importação de dados de planilha\n\nFormato `.csv`.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr <- read_csv(\"https://raw.githubusercontent.com/emdelponte/paper-coffee-rust-Ethiopia/master/data/survey_clean.csv\")\ncr\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 405 × 13\n    farm region zone       district      lon   lat altitude cultivar shade    \n   <dbl> <chr>  <chr>      <chr>       <dbl> <dbl>    <dbl> <chr>    <chr>    \n 1     1 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 2     2 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 3     3 SNNPR  Bench Maji Debub Bench  35.4  6.90     1434 Mixture  Mid shade\n 4     4 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 5     5 SNNPR  Bench Maji Debub Bench  35.4  6.90     1400 Local    Sun      \n 6     6 SNNPR  Bench Maji Debub Bench  35.4  6.90     1342 Mixture  Mid shade\n 7     7 SNNPR  Bench Maji Debub Bench  35.4  6.90     1432 Mixture  Mid shade\n 8     8 SNNPR  Bench Maji Debub Bench  35.4  6.90     1100 Local    Sun      \n 9     9 SNNPR  Bench Maji Debub Bench  35.4  6.89     1400 Local    Sun      \n10    10 SNNPR  Bench Maji Debub Bench  35.4  6.88     1342 Mixture  Mid shade\n# ℹ 395 more rows\n# ℹ 4 more variables: cropping_system <chr>, farm_management <chr>, inc <dbl>,\n#   sev2 <dbl>\n```\n\n\n:::\n:::\n\n\nRealizando a contagem do número de observações do conjunto de dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(region, zone)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 9 × 3\n  region zone             n\n  <chr>  <chr>        <int>\n1 Oromia Bale            30\n2 Oromia Ilu AbaBora     45\n3 Oromia Jimma           45\n4 Oromia West Wellega    45\n5 SNNPR  Bench Maji      45\n6 SNNPR  Gedio           45\n7 SNNPR  Keffa           45\n8 SNNPR  Sheka           45\n9 SNNPR  Sidama          60\n```\n\n\n:::\n:::\n\n\nCriando uma tabela com tabulações cruzadas em formato data frame tibble.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  tabyl(cultivar, region)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n cultivar Oromia SNNPR\n Improved     23    60\n    Local     50    66\n  Mixture     92   114\n```\n\n\n:::\n:::\n\n\nCriando gráficos de coluna. Faz o empilhamento das colunas. Padrão steck.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col()\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\nGráfico de barras lado a lado. Alterando a posição (dodge)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge\")\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nAlterando as cores.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management))+\n  geom_col(position = \"dodge\") +\n  scale_fill_calc()+\n  facet_wrap(~cultivar, scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nAdicionando os valores sobre as colunas do gráfico.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncr |> \n  count(farm_management, cultivar) |> \n  ggplot(aes(cultivar, n, fill = farm_management, label = n))+\n  geom_col(position = \"dodge\") +\n  scale_fill_calc()+\n  theme_bw()+\n  theme(strip.text.x = element_blank(),\n        legend.position = \"top\")+\n  geom_text(position = position_dodge(width = 0.9))+\n  facet_wrap(~cultivar, scales = \"free_x\")\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nImportando dados de planilha online.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg <- gsheet2tbl(\"https://docs.google.com/spreadsheets/d/1aID5Dh6PlBVCKzU1j7k-WA6zuWQWE2NhtWEgdJtt5iA/edit?usp=sharing\")\nmg\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 20 × 3\n   trat      rep  comp\n   <chr>   <dbl> <dbl>\n 1 Mg2         1   9  \n 2 Mg2         2  12.5\n 3 Mg2         3  10  \n 4 Mg2         4   8  \n 5 Mg2         5  13.2\n 6 Mg2         6  11  \n 7 Mg2         7  10.8\n 8 Mg2         8   9.5\n 9 Mg2         9  10.8\n10 Mg2        10  10.4\n11 control     1  13.7\n12 control     2  15.9\n13 control     3  15.7\n14 control     4  14.2\n15 control     5  15.9\n16 control     6  16.5\n17 control     7  18  \n18 control     8  14.4\n19 control     9  16.4\n20 control    10  16  \n```\n\n\n:::\n:::\n\n\nCriando gráficos de colunas com médias e desvio padrão.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg |>\n  group_by(trat) |> \n  summarise(mean_comp = mean(comp), sd_comp = sd(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nPara remover a coluna do gráfico, basta isolar a linha de comando. Não é necessário manter a coluna.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmg |>\n  group_by(trat) |> \n  summarise(mean_comp = mean(comp), sd_comp = sd(comp)) |> \n  ggplot(aes(trat, mean_comp))+\n  #geom_col(fill = \"steelblue\", width = 0.5)+\n  geom_errorbar(aes(ymin = mean_comp - sd_comp,\n                    ymax = mean_comp + sd_comp),\n                width = 0.1)\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmg |> \n  group_by(trat) |> \n    summarise(mean_comp = mean(comp), \n              sd_comp = sd(comp)) |> \n    ggplot(aes(trat, mean_comp)) + \n    #geom_col(fill = 'red', width = 0.5) +\n    geom_point(size = 3) +\n    ylim(5, 20) +\n    geom_errorbar(aes(ymin = mean_comp - sd_comp, \n                      ymax = mean_comp + sd_comp), \n                  width = 0.05) +\n    annotate(geom = 'text',\n           x = 1, y = 17.5,\n           label = \"*\")\n```\n\n::: {.cell-output-display}\n![](aula_04_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}